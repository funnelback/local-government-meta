/*! For license information please see AutocompleteProvider-e47ee2fe4149ff9600a8.js.LICENSE.txt */
(self.webpackChunkPlug_and_Play_Template=self.webpackChunkPlug_and_Play_Template||[]).push([[701],{64945:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});r(33948);var n=r(67294),o=r(45697),a=r.n(o),c=r(27354),s=r(98069);class l{constructor(e){if(!e||0===e.length)throw new Error("At least one adapter is required for AutocompleteService");this.autocompleteAdapters=[],Array.from(e).forEach((e=>{if(!e||!e.hasOwnProperty("autocomplete"))throw new Error("".concat(e.constructor.name," is not implemented yet"));this.registerAdapter(e)}))}registerAdapter(e){this.autocompleteAdapters.push(e)}getResults(e,t){return Promise.all(this.autocompleteAdapters.map((r=>r.getResults(e,t)))).then((e=>{const t=[];let r=0,n=0;return e.map(((e,o)=>{let{data:a}=e;return r+=a.length,t[o]=[],a.length&&a.forEach((e=>{t[o][n++]=e})),t})),{results:t,count:r}})).catch((e=>(console.error(e),{results:0,count:0,error:e})))}}var i=r(48131),u=r(6838),d=r(66004);function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function m(e){const{id:t,templates:o,placeholder:a,debounce:l,action:u,method:m,hiddenFields:f,inputAttributes:v,showSubmit:h}=e,{setSelectedIndex:y,selectedIndex:E,count:g,fetchResults:b}=(0,i.o)(),[x,k]=(0,n.useState)(null),[w,S]=(0,n.useState)(null),[C,_]=(0,n.useState)(null),[P,T]=(0,n.useState)(""),[j,N]=(0,n.useState)(""),[R,I]=(0,n.useState)(!1),O=(0,n.useRef)(),q=(0,n.createRef)(),A=(0,d.uY)(),[D,U]=(0,d.S5)(),{keyboardProps:L}=(0,c.v5)({onKeyUp:e=>{let t=-1;if(27===e.keyCode)return _(!1),void y(-1);if(40===e.keyCode&&(t=E+1>=g?0:E+1),38===e.keyCode&&(t=E-1<0?g-1:E-1),13===e.keyCode){if(-1===E)return void S(!0);D[E].click()}y(t),k(t),_(g>0)},onKeyDown:e=>(40!==e.keyCode&&38!==e.keyCode&&13!==e.keyCode||e.preventDefault(),!1)}),{focusWithinProps:M}=(0,c.L_)({onFocusWithin:()=>{_(g>0),I(!0)},onBlurWithin:()=>{_(!1)}});(0,n.useEffect)((()=>{const e=(0,d.jS)(document.location.href,"query");T(e||"")}),[]),(0,n.useEffect)((()=>{if(_(g>0),!P)return;const e=g>0?"".concat(g," results for ").concat(P):"No results found for ".concat(P);N(e)}),[g,P]),(0,n.useEffect)((()=>{const e=setTimeout((async()=>{await b(P,o)}),l);return()=>clearTimeout(e)}),[P]),(0,n.useEffect)((()=>{if(w&&O.current&&q.current){if(q.current.value=P,A){const e={TYPE:"SUBMIT",title:"NEEDS_REFRESH",url:window.location.href,time:Date.now()};return void A.trackedEventWithCb(e,O.current.submit())}O.current.submit()}}),[w]);const F=(e,t,r)=>{if(A){const n={TYPE:"CLICK",url:e,query:P,title:t};A.trackedEventWithCb(n,r)}r&&!A&&r()},W=(e,t)=>{e.preventDefault();const{action:r,action_t:n,title:o}=t;if("Q"===n||void 0===n)return T(r||t),void S(!0);F(r,o,(()=>document.location.href=r))};return n.createElement("div",p({className:"autocomplete-concierge no-wysiwyg",role:"search"},M),n.createElement("form",p({ref:O,action:u,method:m,className:"autocomplete-concierge__form"},L),n.createElement("label",{className:"sr-only","aria-live":"polite",id:"".concat(t,"-label")},j),n.createElement("input",p({id:"".concat(t,"-inputField"),ref:q,type:"text",autoComplete:"off",role:"combobox","aria-expanded":R&&C,"aria-haspopup":"grid","aria-labelledby":"".concat(t,"-label"),"aria-autocomplete":"list","aria-controls":"".concat(t,"-grid"),"aria-activedescendant":-1===x?void 0:x,onChange:e=>{let{currentTarget:{value:t}}=e;T(t)},onClick:()=>_(g>0),value:P,placeholder:a,className:"autocomplete-concierge__input",name:"query"},v)),f&&f.map((e=>n.createElement("input",{key:e.id,type:"hidden",name:e.name,value:e.value}))),h&&n.createElement("button",{type:"submit",className:"autocomplete-concierge__submit",onClick:()=>S(!0),"aria-labelledby":"".concat(t,"-submit-label")},n.createElement("svg",{className:"svg-icon",role:"img",focusable:!1},n.createElement("title",{id:"".concat(t,"-submit-label")},"Submit search"),n.createElement("use",{href:"#search"})))),n.createElement("div",p({role:"grid","aria-labelledby":"".concat(t,"-label"),id:"".concat(t,"-grid"),className:["autocomplete-concierge__results",(!R||!C)&&"hidden"].join(" "),tabIndex:-1},L),o&&o.map(((e,t)=>(e=>{const{template:t}=e,o=t.toLowerCase(),a=(0,n.useMemo)((()=>(0,n.lazy)((()=>r(42276)("./".concat(o))))),[]);return n.createElement(n.Suspense,{key:"component-".concat(o),fallback:n.createElement("span",{className:"sr-only"},"Loading component...")},n.createElement(a,e))})({...e,templateId:t,handleClick:W,trackedClick:F,childRefs:U})))),n.createElement(s.U4,{onDismiss:()=>_(!1)}))}function f(e){const{adapters:t}=e,r=new l(t);return n.createElement(i.g,{initialState:u.E3,reducer:u.fG,autocompleteService:r},n.createElement(m,e))}const{string:v,arrayOf:h,shape:y,number:E,bool:g}=a();m.propTypes={id:v,templates:h(y({id:v,label:v,template:v,serviceUrl:v,params:v})).isRequired,placeholder:v,debounce:E,action:v,method:v,showSubmit:g},m.defaultProps={id:"autocomplete-search",placeholder:"Start your search here...",debounce:500,action:"search.html",method:"GET",showSubmit:!0}},6838:function(e,t,r){"use strict";r.d(t,{E3:function(){return a},Ix:function(){return s},fG:function(){return c}});const n="PNP/AUTOCOMPLETE/UPDATE_RESULTS",o="PNP/AUTOCOMPLETE/SET_SELECTED",a={results:[],count:0,query:"",selectedIndex:-1},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n:return{...e,results:t.results,count:t.count,query:t.query,selectedIndex:-1};case o:return{...e,selectedIndex:t.selectedIndex};default:return{...e}}},s=(e,t)=>({updateResults:(t,r)=>{e({type:n,results:t,count:r})},setSelectedIndex:t=>{e({type:o,selectedIndex:t})},fetchResults:async r=>{if(!r)return void e({type:n,results:[],count:0});const{results:o,count:a,error:c}=await t.getResults(r);if(c)return console.error("There was an error fetching results from the service."),console.info(c.message),void e({type:n,results:[],count:0});e({type:n,results:o,count:a,query:r})}})},48131:function(e,t,r){"use strict";r.d(t,{g:function(){return s},o:function(){return c}});r(33948);var n=r(67294),o=r(6838);const a=(0,n.createContext)();a.displayName="PNP-STORE";const c=()=>(0,n.useContext)(a),s=e=>{let{children:t,initialState:r,reducer:c,autocompleteService:s}=e;const[l,i]=(0,n.useReducer)(c,r),u=(0,n.useMemo)((()=>(0,o.Ix)(i,s)),[]);return n.createElement(a.Provider,{value:{...u,dispatch:i,...l}},t)}},42276:function(e,t,r){var n={"./cemetery--v15":[98938,938],"./cemetery--v15.jsx":[98938,938],"./cemetery--v16":[97841,841],"./cemetery--v16.jsx":[97841,841],"./faqs--v15":[81524,524],"./faqs--v15.jsx":[81524,524],"./faqs--v16":[20080,80],"./faqs--v16.jsx":[20080,80],"./organic":[44113,113],"./organic.jsx":[44113,113],"./people--v15":[62140,140],"./people--v15.jsx":[62140,140],"./people--v16":[12507,507],"./people--v16.jsx":[12507,507],"./planning_applications--v15":[53298,298],"./planning_applications--v15.jsx":[53298,298],"./planning_applications--v16":[38504,504],"./planning_applications--v16.jsx":[38504,504],"./programs--v15":[86588,588],"./programs--v15.jsx":[86588,588],"./programs--v16":[32723,723],"./programs--v16.jsx":[32723,723],"./roadworks--v15":[75554,554],"./roadworks--v15.jsx":[75554,554],"./roadworks--v16":[54563,563],"./roadworks--v16.jsx":[54563,563],"./services--v15":[91362,362],"./services--v15.jsx":[91362,362],"./services--v16 ":[45542,542],"./services--v16 .jsx":[45542,542]};function o(e){if(!r.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return r.e(t[1]).then((function(){return r(o)}))}o.keys=function(){return Object.keys(n)},o.id=42276,e.exports=o}}]);
//# sourceMappingURL=AutocompleteProvider-e47ee2fe4149ff9600a8.js.map
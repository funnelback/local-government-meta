{"version":3,"file":"js/AutocompleteProvider-8fe9dfa72f4b8c109df3.js","mappings":"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","sources":["webpack://Plug-and-Play-Template/./src/modules/_data-layer/js/Services/AutocompleteService/AutocompleteService.js","webpack://Plug-and-Play-Template/./src/modules/autocomplete-concierge/jsx/autocomplete.jsx","webpack://Plug-and-Play-Template/./src/modules/autocomplete-concierge/jsx/reducer.js","webpack://Plug-and-Play-Template/./src/modules/autocomplete-concierge/jsx/store.jsx","webpack://Plug-and-Play-Template/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://Plug-and-Play-Template/./node_modules/prop-types/index.js","webpack://Plug-and-Play-Template/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://Plug-and-Play-Template/./src/modules/autocomplete-concierge/jsx/templates|lazy|/^\\.\\/.*$/|groupOptions: {}|namespace object"],"sourcesContent":["/*!\n * @license\n * Copyright Squiz Australia Pty Ltd. All Rights Reserved.\n */\n\n/* eslint-disable import/prefer-default-export */\n\nexport class AutocompleteService {\n    constructor(adapters) {\n        if (!adapters || adapters.length === 0) {\n            throw new Error(\n                `At least one adapter is required for AutocompleteService`\n            );\n        }\n\n        this.autocompleteAdapters = [];\n\n        Array.from(adapters).forEach((adapter) => {\n            // eslint-disable-next-line no-prototype-builtins\n            if (!adapter || !adapter.hasOwnProperty('autocomplete')) {\n                throw new Error(\n                    `${adapter.constructor.name} is not implemented yet`\n                );\n            } else {\n                this.registerAdapter(adapter);\n            }\n        });\n    }\n\n    registerAdapter(adapter) {\n        this.autocompleteAdapters.push(adapter);\n    }\n\n    /**\n     * Get search results.\n     *\n     * @param {string} args query string.\n     * @param {function} mockFn Unit test mock function.\n     *\n     * @returns {Promise<array>} A promised list of search results.\n     */\n    getResults(args, mockFn) {\n        return Promise.all(\n            this.autocompleteAdapters.map((adapter) =>\n                adapter.getResults(args, mockFn)\n            )\n        )\n            .then((result) => {\n                const mappedResults = [];\n                let resultsCount = 0;\n                let i = 0;\n\n                // Match each result with its template id.\n                result.map(({ data }, idx) => {\n                    resultsCount += data.length;\n                    mappedResults[idx] = [];\n                    if (data.length) {\n                        data.forEach((element) => {\n                            // eslint-disable-next-line no-plusplus\n                            mappedResults[idx][i++] = element;\n                        });\n                    }\n                    return mappedResults;\n                });\n\n                return { results: mappedResults, count: resultsCount };\n            })\n            .catch((error) => {\n                /* eslint-disable no-console */\n                console.error(error);\n                return { results: 0, count: 0, error };\n            });\n    }\n}\n","/* eslint-disable react/jsx-props-no-spreading */\n/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React, {\n    useState,\n    useEffect,\n    useMemo,\n    Suspense,\n    lazy,\n    useRef,\n    createRef,\n} from 'react';\nimport PropTypes from 'prop-types';\nimport { useKeyboard, useFocusWithin } from '@react-aria/interactions';\n\nimport { AutocompleteService } from 'PlugAndPlay/_data-layer/js/Services/AutocompleteService/AutocompleteService';\nimport { useStore, StoreProvider } from './store';\nimport { initialState, searchReducer } from './reducer';\nimport { useArrayRef, getParam, getTracker } from './helpers';\n\n/**\n * Lazy load result templates. We could not use standard hook to laad, as we need to pass array of refs.\n * With memo we caching function but still have ability to rebuild props when refs are changed.\n *\n * @param {object} props Object with props we want to pass into component.\n *\n * @returns {JSX.Element}\n * @constructor\n */\nconst LoadTemplates = (props) => {\n    const { template } = props;\n    const componentName = template.toLowerCase();\n    const DynamicComponent = useMemo(\n        () => lazy(() => import(`./templates/${componentName}`)),\n        []\n    );\n\n    return (\n        <Suspense\n            key={`component-${componentName}`}\n            fallback={<span className=\"sr-only\">Loading component...</span>}\n        >\n            <DynamicComponent {...props} />\n        </Suspense>\n    );\n};\n\nfunction Autocomplete(props) {\n    const {\n        id,\n        templates,\n        placeholder,\n        debounce,\n        action,\n        method,\n        hiddenFields,\n        inputAttributes,\n        showSubmit,\n    } = props;\n\n    const { setSelectedIndex, selectedIndex, count, fetchResults } = useStore();\n\n    const [activeDescendant, setActiveDescendant] = useState(null);\n    const [submit, setSubmit] = useState(null);\n    const [showResults, setShowResults] = useState(null);\n    const [query, setQuery] = useState(``);\n    const [readerAnnounce, setReaderAnnounce] = useState(``);\n    const [isInputFocused, setIsInputFocused] = useState(false);\n\n    const formRef = useRef();\n    const searchBox = createRef();\n    const tracker = getTracker();\n\n    const [elements, childRefs] = useArrayRef();\n\n    const { keyboardProps } = useKeyboard({\n        onKeyUp: (e) => {\n            let index = -1;\n            // ESC\n            if (e.keyCode === 27) {\n                setShowResults(false);\n                setSelectedIndex(-1);\n                return;\n            }\n            // Down\n            if (e.keyCode === 40) {\n                index = selectedIndex + 1 >= count ? 0 : selectedIndex + 1;\n            }\n            // Up\n            if (e.keyCode === 38) {\n                index = selectedIndex - 1 < 0 ? count - 1 : selectedIndex - 1;\n            }\n            // Enter\n            if (e.keyCode === 13) {\n                // Nothing selected and enter hit we will post form.\n                if (selectedIndex === -1) {\n                    setSubmit(true);\n                    return;\n                }\n\n                // We will fire onClick event when enter hit\n                elements[selectedIndex].click();\n            }\n\n            setSelectedIndex(index);\n            setActiveDescendant(index);\n            setShowResults(count > 0);\n        },\n        onKeyDown: (e) => {\n            // This wil prevent moving cursor on input field when press down or up also stop form from being posted when enter pressed.\n            if (e.keyCode === 40 || e.keyCode === 38 || e.keyCode === 13) {\n                e.preventDefault();\n            }\n            return false;\n        },\n    });\n\n    // This is to handle clicks outside the combobox.\n    const { focusWithinProps } = useFocusWithin({\n        onFocusWithin: () => {\n            setShowResults(count > 0);\n        },\n        onBlurWithin: () => {\n            setShowResults(false);\n        },\n    });\n\n    // On page load update input field with query string.\n    useEffect(() => {\n        const queryParam = getParam(document.location.href, 'query');\n        setQuery(queryParam || ``);\n    }, []);\n\n    // Let the screen readers know we have or not results.\n    useEffect(() => {\n        setShowResults(count > 0);\n        const message =\n            count > 0\n                ? `${count} results for ${query}`\n                : `No results found for ${query}`;\n\n        setReaderAnnounce(message);\n    }, [count, query]);\n\n    // When query changed we debounce network request.\n    useEffect(() => {\n        const delayDebounceFn = setTimeout(async () => {\n            await fetchResults(query, templates);\n        }, debounce);\n\n        return () => clearTimeout(delayDebounceFn);\n    }, [query]);\n\n    // This is to handle form submissions including tracker.\n    useEffect(() => {\n        if (submit && formRef.current && searchBox.current) {\n            searchBox.current.value = query;\n            if (tracker) {\n                const trackingEvent = {\n                    TYPE: 'SUBMIT',\n                    title: 'NEEDS_REFRESH',\n                    url: window.location.href,\n                    time: Date.now(),\n                };\n                tracker.trackedEventWithCb(\n                    trackingEvent,\n                    formRef.current.submit()\n                );\n                return;\n            }\n\n            formRef.current.submit();\n        }\n    }, [submit]);\n\n    const handleInputOnChange = ({ currentTarget: { value } }) => {\n        setQuery(value);\n    };\n\n    // Standard onClick handler, can be overridden within template component.\n    const handleClick = (e, value) => {\n        e.preventDefault();\n        setQuery(value);\n        setSubmit(true);\n    };\n\n    const trackedClick = (url, title, cb) => {\n        if (tracker) {\n            const trackingEvent = {\n                TYPE: 'CLICK',\n                url,\n                query,\n                title,\n            };\n            tracker.trackedEventWithCb(trackingEvent, cb);\n        }\n        if (cb && !tracker) {\n            cb();\n        }\n    };\n\n    return (\n        <div className=\"autocomplete-concierge no-wysiwyg\" role=\"search\">\n            <div\n                {...focusWithinProps}\n                role=\"combobox\"\n                aria-expanded={showResults}\n                aria-owns={`${id}-grid`}\n                aria-haspopup=\"grid\"\n                aria-controls={`${id}-input`}\n                id={`${id}-combobox`}\n            >\n                <div className=\"sr-only\" aria-live=\"polite\">\n                    {readerAnnounce}\n                </div>\n                <form\n                    ref={formRef}\n                    action={action}\n                    method={method}\n                    className=\"autocomplete-concierge__form-wrapper\"\n                    {...keyboardProps}\n                >\n                    <label\n                        htmlFor={`${id}-inputField`}\n                        id={`${id}-label`}\n                        className=\"sr-only\"\n                    >\n                        Autocomplete search concierge\n                    </label>\n                    <input\n                        ref={searchBox}\n                        type=\"text\"\n                        id={`${id}-inputField`}\n                        autoComplete=\"off\"\n                        aria-autocomplete=\"list\"\n                        aria-controls={`${id}-grid`}\n                        aria-activedescendant={\n                            activeDescendant === -1\n                                ? undefined\n                                : activeDescendant\n                        }\n                        placeholder={placeholder}\n                        onChange={handleInputOnChange}\n                        onClick={() => setShowResults(count > 0)}\n                        value={query}\n                        className=\"autocomplete-concierge__input\"\n                        name=\"query\"\n                        onBlur={() => {\n                            setTimeout(() => setIsInputFocused(false), 200);\n                        }}\n                        onFocus={() => {\n                            setTimeout(() => setIsInputFocused(true), 200);\n                        }}\n                        {...inputAttributes}\n                    />\n                    {hiddenFields &&\n                        hiddenFields.map((el) => (\n                            <input\n                                key={el.id}\n                                type=\"hidden\"\n                                name={el.name}\n                                value={el.value}\n                            />\n                        ))}\n                    {showSubmit && (\n                        <button\n                            type=\"submit\"\n                            className=\"autocomplete-concierge__submit\"\n                            onClick={() => setSubmit(true)}\n                        >\n                            <svg className=\"svg-icon\">\n                                <title>Submit search</title>\n                                <use href=\"#search\" />\n                            </svg>\n                        </button>\n                    )}\n                </form>\n                <div\n                    {...keyboardProps}\n                    role=\"grid\"\n                    aria-labelledby={`${id}-label`}\n                    id={`${id}-grid`}\n                    className={[\n                        `autocomplete-concierge__results`,\n                        (!isInputFocused || !showResults) && `hidden`,\n                    ].join(' ')}\n                    tabIndex={-1}\n                >\n                    {templates &&\n                        templates.map((el, templateId) =>\n                            LoadTemplates({\n                                ...el,\n                                templateId,\n                                handleClick,\n                                trackedClick,\n                                childRefs,\n                            })\n                        )}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default function AutocompleteProvider(props) {\n    const { adapters } = props;\n    const autocompleteService = new AutocompleteService(adapters);\n\n    return (\n        <StoreProvider\n            initialState={initialState}\n            reducer={searchReducer}\n            autocompleteService={autocompleteService}\n        >\n            <Autocomplete {...props} />\n        </StoreProvider>\n    );\n}\n\nconst { string, arrayOf, shape, number, bool } = PropTypes;\n\nAutocomplete.propTypes = {\n    id: string,\n    templates: arrayOf(\n        shape({\n            id: string,\n            label: string,\n            template: string,\n            serviceUrl: string,\n            params: string,\n        })\n    ).isRequired,\n    placeholder: string,\n    debounce: number,\n    action: string,\n    method: string,\n    showSubmit: bool,\n};\n\nAutocomplete.defaultProps = {\n    id: 'autocomplete-search',\n    placeholder: 'Start your search here...',\n    debounce: 500,\n    action: 'search.html',\n    method: 'GET',\n    showSubmit: true,\n};\n","/* eslint-disable no-console */\n\nexport const UPDATE_QUERY = 'PNP/AUTOCOMPLETE/UPDATE_QUERY';\nexport const UPDATE_RESULTS = 'PNP/AUTOCOMPLETE/UPDATE_RESULTS';\nexport const SET_SELECTED = 'PNP/AUTOCOMPLETE/SET_SELECTED';\n\nexport const initialState = {\n    results: [],\n    count: 0,\n    query: ``,\n    selectedIndex: -1,\n};\n\nexport const searchReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case UPDATE_RESULTS:\n            return {\n                ...state,\n                results: action.results,\n                count: action.count,\n                query: action.query,\n                selectedIndex: -1,\n            };\n        case SET_SELECTED:\n            return {\n                ...state,\n                selectedIndex: action.selectedIndex,\n            };\n        default:\n            return { ...state };\n    }\n};\n\nexport const autocompleteContext = (dispatch, service) => ({\n    updateResults: (results, count) => {\n        dispatch({\n            type: UPDATE_RESULTS,\n            results,\n            count,\n        });\n    },\n    setSelectedIndex: (selectedIndex) => {\n        dispatch({\n            type: SET_SELECTED,\n            selectedIndex,\n        });\n    },\n    fetchResults: async (query) => {\n        if (!query) {\n            dispatch({\n                type: UPDATE_RESULTS,\n                results: [],\n                count: 0,\n            });\n            return;\n        }\n\n        const { results, count, error } = await service.getResults(query);\n\n        if (error) {\n            console.error(\n                `There was an error fetching results from the service.`\n            );\n            console.info(error.message);\n\n            dispatch({\n                type: UPDATE_RESULTS,\n                results: [],\n                count: 0,\n            });\n            return;\n        }\n\n        dispatch({\n            type: UPDATE_RESULTS,\n            results,\n            count,\n            query,\n        });\n    },\n});\n","import React, { useReducer, useContext, createContext, useMemo } from 'react';\nimport { autocompleteContext } from './reducer';\n\nconst Store = createContext();\n\nStore.displayName = 'PNP-STORE';\n\nexport const useStore = () => useContext(Store);\n\nexport const StoreProvider = ({\n    children,\n    initialState,\n    reducer,\n    autocompleteService,\n}) => {\n    const [state, dispatch] = useReducer(reducer, initialState);\n    const autocomplete = useMemo(\n        () => autocompleteContext(dispatch, autocompleteService),\n        []\n    );\n\n    return (\n        <Store.Provider value={{ ...autocomplete, dispatch, ...state }}>\n            {children}\n        </Store.Provider>\n    );\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","var map = {\n\t\"./organic\": [\n\t\t44113,\n\t\t113\n\t],\n\t\"./organic.jsx\": [\n\t\t44113,\n\t\t113\n\t],\n\t\"./people--v15\": [\n\t\t62140,\n\t\t140\n\t],\n\t\"./people--v15.jsx\": [\n\t\t62140,\n\t\t140\n\t],\n\t\"./people--v16\": [\n\t\t12507,\n\t\t507\n\t],\n\t\"./people--v16.jsx\": [\n\t\t12507,\n\t\t507\n\t],\n\t\"./programs--v15\": [\n\t\t53700,\n\t\t588\n\t],\n\t\"./programs--v15.jsx\": [\n\t\t53700,\n\t\t588\n\t],\n\t\"./programs--v16\": [\n\t\t32723,\n\t\t723\n\t],\n\t\"./programs--v16.jsx\": [\n\t\t32723,\n\t\t723\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 42276;\nmodule.exports = webpackAsyncContext;"],"names":["AutocompleteService","constructor","adapters","length","Error","this","autocompleteAdapters","Array","from","forEach","adapter","hasOwnProperty","name","registerAdapter","push","getResults","args","mockFn","Promise","all","map","then","result","mappedResults","resultsCount","i","idx","data","element","results","count","catch","error","console","Autocomplete","props","id","templates","placeholder","debounce","action","method","hiddenFields","inputAttributes","showSubmit","setSelectedIndex","selectedIndex","fetchResults","useStore","activeDescendant","setActiveDescendant","useState","submit","setSubmit","showResults","setShowResults","query","setQuery","readerAnnounce","setReaderAnnounce","isInputFocused","setIsInputFocused","formRef","useRef","searchBox","createRef","tracker","getTracker","elements","childRefs","useArrayRef","keyboardProps","useKeyboard","onKeyUp","e","index","keyCode","click","onKeyDown","preventDefault","focusWithinProps","useFocusWithin","onFocusWithin","onBlurWithin","useEffect","queryParam","getParam","document","location","href","message","delayDebounceFn","setTimeout","async","clearTimeout","current","value","trackingEvent","TYPE","title","url","window","time","Date","now","trackedEventWithCb","handleClick","trackedClick","cb","className","role","ref","htmlFor","type","autoComplete","undefined","onChange","currentTarget","onClick","onBlur","onFocus","el","key","join","tabIndex","templateId","template","componentName","toLowerCase","DynamicComponent","useMemo","lazy","Suspense","fallback","LoadTemplates","AutocompleteProvider","autocompleteService","initialState","reducer","searchReducer","string","arrayOf","shape","number","bool","PropTypes","propTypes","label","serviceUrl","params","isRequired","defaultProps","UPDATE_RESULTS","SET_SELECTED","state","autocompleteContext","dispatch","service","updateResults","info","Store","createContext","displayName","useContext","StoreProvider","children","useReducer","autocomplete","Provider","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","module","exports","shim","propName","propFullName","secret","err","getShim","ReactPropTypes","array","bigint","func","object","symbol","any","elementType","instanceOf","node","objectOf","oneOf","oneOfType","exact","checkPropTypes","webpackAsyncContext","req","__webpack_require__","o","resolve","code","ids","keys","Object"],"sourceRoot":""}